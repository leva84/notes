# Тестовое задание
### Создать вэб-приложения для заметок
* Версия Ruby `3.1.3`
* Версия Rails `7.0.5`
* [Развернутое приложение NOTES](https://notes-mjgb.onrender.com)
##

### Описание
РЕЗЮМЕ: Используя Rails 7 и Bootstrap 5, создайте приложение, которое позволит пользователям добавлять, редактировать и удалять простые заметки.

1. Используя гем Devise, добавьте функциональность регистрации и входа в систему и добавьте заголовок с ссылками "Вход" и "Выход", а также полное имя пользователя.

2. Добавьте метку "N заметок" в центре заголовка, где N - это количество заметок.

3. В основном разделе страницы добавьте таблицу со следующими столбцами:
    - a. Номер строки (#),
    - b. Текст заметки,
    - c. Имя автора,
    - d. Дата создания и
    - e. Кнопка удаления (иконка мусорного ведра).

4. Все столбцы, кроме столбца с заметкой, должны иметь фиксированную ширину.
5. Столбец "Автор" отображает имя пользователя и всплывающую подсказку с его полным именем.

6. Столбец "Дата" отображает дату создания заметки и всплывающую подсказку со временем создания.

7. Столбец "Удалить" отображает иконку мусорного ведра с всплывающей подсказкой "Удалить". При нажатии показывается окно подтверждения с текстом "Вы уверены?".
    - a. Используйте Hotwire для удаления заметки без обновления страницы, чтобы соответствующая строка исчезла.
    - b. Иконка мусорного ведра, если текущий пользователь является автором заметки, в противном случае используйте другую иконку с подсказкой "Вы можете удалить только свою заметку".

8. Если пользователь вошел в систему, добавьте строку в конец таблицы с текстовым полем для ввода с текстом-заполнителем "НАПИШИТЕ НОВУЮ ЗАМЕТКУ". Настраивайте внешний вид по желанию, например преобразовывая текст в верхний регистр.

9. После внесения изменений в поле ввода автоматически сохраняйте заметку в базе данных и отображайте новую строку в таблице с соответствующими данными в столбцах.
    - a. Используйте Hotwire для достижения этого без обновления страницы. Если заметка успешно сохранена, отобразите сообщение об успешном сохранении.

10. Ширина таблицы должна быть не более 640 пикселей и не менее 300 пикселей. Если ширина экрана больше 860 пикселей, переместите заголовок справа от таблицы.

11. Добавьте постраничную навигацию с 5 строками на страницу для таблицы. Строка новой заметки не должна считаться одной из 5 заметок и должна быть видна на каждой странице заметок.

12. Обеспечьте покрытие тестами для приложения с использованием RSpec.

13. Разверните приложение на хостинг-среде.

### Деплой

Развертывание производилось на платформе [RENDER](https://render.com/docs/deploys). 
Дальнейшие шаги будут описаны для развертывания данного приложения на вышеуказанном хостинге.

#### Шаги:

* Копируем фалы конфигураций и настраиваем их под свою среду развертывания.
```
cp config/database.yml.example config/database.yml
cp config/redis.yml.example config/redis.yml
cp config/storage.yml.example config/storage.yml
```

* Если разработка и установка зависимостей происходила на операционной системе отличной от `x86_64-linux`,
то добавит в Gemfile.lock следующую строку (можно просто руками).
В противном случае `bundler` не сделает сборку зависимостей.
```
PLATFORMS
   ...
   x86_64-linux

```

* Для облегчения хранения команд сборки на стороне удаленного сервера пожно создать файл `bin/render-build.sh`,
 со следующим содержимым.
```
#!/usr/bin/env bash
 # exit on error
 set -o errexit

 bundle install
 bundle exec rake assets:precompile
 bundle exec rake assets:clean
 bundle exec rake db:migrate
```
* Эти команды сборки можно прописать в настройках сайта в `Build Command`, а можно просто указать этот файл сборки
  следующим образом `bin/render-build.sh`. После создания данного файла у себя на локальной машине стоит выполнить
  команду `chmod a+x bin/render-build.sh` что бы предоставить права сборки.

* Эту переменную окружения `DATABASE_URL` необходимо добавить в настройка на удаленном сервере, значение для нее необходимо получить
  при создании web-сайта на платформе RENDER.

* В `config/database.yml` в `production` необходимо вставить следующее.
```
production:
   <<: *default
   url: <%= ENV['DATABASE_URL'] %>
```

* В `config/environments/production.rb` необходимо найти следующую строку
```
  config.public_file_server.enabled = ENV["RAILS_SERVE_STATIC_FILES"].present?
```
и добавить в конец следующее `|| ENV['RENDER'].present?`, что бы строка выглядела так.
```
  config.public_file_server.enabled = ENV["RAILS_SERVE_STATIC_FILES"].present? || ENV['RENDER'].present?
```

* Необходимо настроить конфигурацию `puma` в `config/puma.rb`, раскоментировать следующие строки если они закомичены.
```
workers ENV.fetch("WEB_CONCURRENCY") { 2 }
preload_app!
```
* Данную `REDIS_URL` переменную окружения необходимо получить при создании web-сайта на платформе RENDER
  и добавить в настройка на удаленном сервере

* Необходимо настроить конфигурацию `Redis` для production.
```
production:
   url: <%= ENV['REDIS_URL'] %>
```

* Так нужно будет на платформе RENDER создать переменную окружения `RAILS_MASTER_KEY` куда передать master_key
из `config/master.key` вашего приложения.

* Последними шагами будут: создание удаленного репозитория, конект удаленного репозитория с платформой RENDER,
настройка переменных окружения на платформе RENDER и собственно деплой.
